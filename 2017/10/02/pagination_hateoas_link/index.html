<!DOCTYPE html>
<html lang="en">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.75.1" />

    
    
    

<title>Pagination en JAX-RS 2.0 avec le header Link • Brice Dutheil</title>













    
<meta property="og:locale" content="en">
<meta property="og:site_name" content="Brice Dutheil">
<meta property="og:title" content="Pagination en JAX-RS 2.0 avec le header Link">
<meta property="og:type" content="website">
<meta property="og:url" content="https://blog.arkey.fr/2017/10/02/pagination_hateoas_link/" />
<meta property="og:description" content="Java mostly, and general tech">
<meta property="og:image" content="https://blog.arkey.fr/social-sharing.png">
<meta property="og:image:type" content="image/png">
    
    
    
<meta property="og:image:width" content="192">
<meta property="og:image:height" content="192">
    

<meta property="og:updated_time" content="2017-10-02T00:00:00Z">



<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@BriceDutheil">
<meta name="twitter:title" content="Pagination en JAX-RS 2.0 avec le header Link">

<meta name="twitter:image" content="https://blog.arkey.fr/social-sharing.png">

<meta name="twitter:description" content="Java mostly, and general tech">
<meta name="twitter:creator" content="@BriceDutheil">
    
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/a11y-light.min.css" media="(prefers-color-scheme: light)"><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/gruvbox-dark.min.css" media="(prefers-color-scheme: dark)">




<link rel="stylesheet" href="/scss/hyde-hyde.157ebce1a9aa8d33b32dc026b8fa65847644aab3c1cb1ff0e1c25efc7ec2491e.css" integrity="sha256-FX684amqjTOzLcAmuPplhHZEqrPByx/w4cJe/H7CSR4=">


<link rel="stylesheet" href="/scss/hyde-hyde-dark.e42accb90675eefea7f835f9f36a333b2e088d399217fcac85044e672158d585.css" integrity="sha256-5CrMuQZ17v6n&#43;DX582ozOy4IjTmSF/yshQROZyFY1YU=" media="(prefers-color-scheme: dark)">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    
    <link rel="shortcut icon" sizes="192x192" href="/android-192-favicon.png">

    
    <link rel="shortcut icon" href="/android-192-favicon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/v4-shims.min.css" integrity="sha256-wN7QJaqAwQ03kgUhyN4EU2phRdDkLrQYbFe0EvpQ60U=" crossorigin="anonymous" />

    
    


    
</head>


    <body class="">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://blog.arkey.fr">Brice Dutheil</a>
      </span>
      
      
        <div class="author-image">
          <img src="https://www.gravatar.com/avatar/f31c7fbcbb0766d0632d96fd7e74b649?s=240&d=mp" class="img--circle img--headshot element--center" alt="gravatar">
        </div>
      
      <p class="site__description">
         Java mostly, and general tech 
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Brice Dutheil</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/"><span class='fa-icon'><i class='fas fa-home'></i></span><code>cd <em>~</em></code>
						<span></span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/posts/"><span class='fa-icon'><i class='fas fa-stream'></i></span><code>ls <em>posts/*</em></code>
						<span></span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/series/"><span class='fa-icon'><i class='fas fa-list-alt'></i></span><code>grep -o <em>series</em> posts/* | sort -u</code>
						<span></span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/tags/"><span class='fa-icon'><i class='fas fa-tags'></i></span><code>grep -o <em>tags</em> posts/* | sort -u</code>
						<span></span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/cool-stuff/"><span class='fa-icon'><i class='fas fa-thumbtack'></i></span><code>cd <em>cool-stuff</em></code>
						<span></span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/whoami/"><span class='fa-icon'><i class='fas fa-id-card'></i></span><code>whoami</code>
						<span></span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/BriceDutheil" rel="me"><i class="fa-w-16" aria-hidden="true"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="bird" class="svg-inline--fa fa-bird fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></i></a>
	
	
	
	<a href="https://github.com/bric3" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://speakerdeck.com/bric3" rel="me"><i class="fab fa-speaker-deck" aria-hidden="true"></i></i></a>
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/dutheilbrice" rel="me"><i class="fa-w-16" aria-hidden="true"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="pro-network" class="svg-inline--fa fa-pro-network fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></i></a>
	
	
	<a href="https://stackoverflow.com/users/48136/brice" rel="me"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
</section>

      </div>
    </div>

  </div>
  <div class="container fixed-container">
    
<div class="copyright">
  &copy; 2010 - 2020 Brice Dutheil
  
    <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>
  
</div>



  </div>
</div>

        <div class="content container">
            
    

<article>
  <header>
    <h1>Pagination en JAX-RS 2.0 avec le header Link</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> 2017-10-02
    
    
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/tags/java">java</a>
           
      
          <a class="badge badge-tag" href="/tags/jaxrs">jaxrs</a>
           
      
          <a class="badge badge-tag" href="/tags/pagination">pagination</a>
           
      
          <a class="badge badge-tag" href="/tags/http">http</a>
           
      
          <a class="badge badge-tag" href="/tags/github">github</a>
          
      
    
    
    <br/>
    <i class="fas fa-clock"></i> 15 min read

    
    
    

</div>


  </header>
  
  
  
  <div class="post md">
    <p>Votre API REST est en place, mais voilà une des resources doit être paginée.
Quelqu&rsquo;en soit la raison, API de recherche, API de listing, etc.</p>
<p>Il y a plusieurs choix possible sur la manière de faire :</p>
<ul>
<li>Ne rien faire c&rsquo;est le client qui contrôle tout pour lister les pages</li>
<li>Dans le body HTTP, envelopper la liste de résultat contenant également les
informations de pagination. C&rsquo;est une approche souvent choisi car elle demande
moins de connaissance du HTTP.</li>
<li>Utiliser la réponse HTTP comme enveloppe et système de meta-données. C&rsquo;est
l&rsquo;option choisie par les designers de
l'<a href="https://developer.github.com/v3/guides/traversing-with-pagination/">API HTTP de GitHub</a></li>
</ul>
<p>Les gens de Github utilisent spécifiquement l&rsquo;entête <code>Link</code> pour exprimer les
<em>relations</em> des pages dans une ressource paginée. Pour ceux qui n&rsquo;ont pas envie
d&rsquo;utiliser le body de la réponse pour introduire ces <em>méta-données</em> de
navigations, cet article explique comment mettre en place avec le standard
JAX-RS 2 un mécanisme comme celui de GitHub.</p>
<h2 id="quest-ce-que-le-header-link">Qu&rsquo;est-ce que le header link?</h2>
<p>D&rsquo;après la <a href="https://tools.ietf.org/html/rfc5988">RFC 5988</a> :</p>
<blockquote>
<p>In this specification, a link is a typed connection between two
resources that are identified by Internationalised Resource
Identifiers (IRIs) [RFC3987], and is comprised of:</p>
<ul>
<li>A context IRI,</li>
<li>a link relation type (Section 4),</li>
<li>a target IRI, and</li>
<li>optionally, target attributes.</li>
</ul>
<p><strong>A link can be viewed as a statement of the form &ldquo;{context IRI} has a
{relation type} resource at {target IRI}, which has {target
attributes}&rdquo;.</strong></p>
</blockquote>
<p>La RFC donne cet exemple :</p>
<pre><code>Link: &lt;http://example.com/TheBook/chapter2&gt;; rel=&quot;previous&quot;; title=&quot;previous chapter&quot;
</code></pre>
<p>L&rsquo;entête <code>Link</code> est donc un moyen de donner au client les URIs des relations
de la ressource actuelle.
Le header HTTP <code>Link</code> peut accueillir plusieurs <em>link</em>, donc plusieurs
relations. Ce qui permet de donner les liens pour naviguer d&rsquo;une page à une
autre comme l&rsquo;a mis en place github. <strong>La réponse HTTP est l&rsquo;enveloppe de
la payload</strong>.</p>
<h2 id="jax-rs-le-prototypage">JAX-RS, le prototypage</h2>
<p>Concrètement comment implémenter cette forme de pagination en JAX-RS ?</p>
<p>On peut utiliser le builder de <code>Response</code> pour ajouter le header <code>Link</code>. Depuis
la spécification JAX-RS 2 il y a un support spécifique pour les header <code>Link</code>,
via le builder <code>.links(Link...)</code> et via la classe <code>Link</code>.</p>
<pre><code class="language-java">Response.ok()
        .links(Link.valueOf(&quot;&lt;https://host:port/path?q=foo&amp;page=72&gt;; rel=\&quot;previous results\&quot;&quot;),
               Link.valueOf(&quot;&lt;https://host:port/path?q=foo&amp;page=74&gt;; rel=\&quot;next results\&quot;&quot;))
        .entity(/* page 73 */ results)
        .build());
</code></pre>
<p>Ce qu&rsquo;il nous faut donc c&rsquo;est l&rsquo;URI complète pour générer les URI des relations.
Avec JAX-RS, il faut récupérer <code>UriInfo</code>. Pour rappel :</p>
<p>Étant donné l&rsquo;URI appelée <code>http://localhost:59520/path/to/search?foo=bar&amp;qix=zzz</code>, alors</p>
<ul>
<li><code>uriInfo.getAbsolutePath()</code> donnera <code>http://localhost:59520/path/to/search</code></li>
<li><code>uriInfo.getBaseUri()</code> donnera <code>http://localhost:59520/</code></li>
<li><code>uriInfo.getPath()</code> donnera <code>path/to/search</code></li>
<li><code>uriInfo.getQueryParameters()</code> donnera une <code>MultivaluedMap</code> avec
<pre><code>&quot;foo&quot; : [&quot;bar&quot;]
&quot;qix&quot; : [&quot;zzz&quot;]
</code></pre>
</li>
<li><code>uriInfo.getRequestUri()</code> donnera <code>http://localhost:59520/path/to/search?foo=bar&amp;qix=zzz</code></li>
</ul>
<p>Dans le contexte d&rsquo;une ressource JAX-RS, on peut par exemple écrire le code
suivant.</p>
<pre><code class="language-java">public static String X_TOTAL_COUNT = &quot;X-Total-Count&quot;;

@Context
UriInfo uriInfo;

@GET @Path(&quot;search&quot;)
public void search(@BeanParam QueryParams queryParams,
                   @Suspended AsyncResponse asyncResponse) {

    SamePaginated results = // get paginated results
    LinkPagination linkPagination = new LinkPagination(results.currentPageIndex(),
                                                       results.pageCount())

    asyncResponse.resume(Response.ok()
                                 .links(linkPagination.toLinks(uriInfo)
                                                      .toArray(Link[]::new))
                                 .header(X_TOTAL_COUNT, results.totalCount())
                                 .entity(results.currentPage())
                                 .build());
}
</code></pre>
<p>Ce code laisse la responsabilité à la classe <code>LinkPagination</code> de générer les
headers <code>Link</code>.</p>
<pre><code class="language-java">import com.google.common.base.Preconditions;

import javax.ws.rs.core.Link;
import javax.ws.rs.core.UriInfo;
import java.util.stream.Stream;

public class LinkPagination {
    public static final String PREV_REL = &quot;prev&quot;;
    public static final String NEXT_REL = &quot;next&quot;;
    public static final String FIRST_REL = &quot;first&quot;;
    public static final String LAST_REL = &quot;last&quot;;
    public static final String PAGE_QUERY_PARAM = &quot;page&quot;;
    public static final int FIRST_PAGE = 1

    public final int pageCount;
    public final int currentPageIndex;

    public LinkPagination(int currentPageIndex, int pageCount) { /* ... */ }

    public Stream&lt;Link&gt; toLinks(UriInfo uriInfo) {
        if (currentPageIndex == 1 &amp;&amp; pageCount == 1) {
            return Stream.empty();
        }

        Stream.Builder&lt;Link&gt; linkStreamBuilder = Stream.builder();

        if (currentPageIndex &gt; 1) {
            linkStreamBuilder.accept(
                Link.fromUriBuilder(uriInfo.getRequestUriBuilder()
                                           .replaceQueryParam(PAGE_QUERY_PARAM,
                                                              currentPageIndex - 1))
                    .rel(PREV_REL)
                    .build());
        }

        if (currentPageIndex &lt; pageCount) {
            linkStreamBuilder.accept(
                Link.fromUriBuilder(uriInfo.getRequestUriBuilder()
                                           .replaceQueryParam(PAGE_QUERY_PARAM,
                                                              currentPageIndex + 1))
                    .rel(NEXT_REL)
                    .build());
        }

        linkStreamBuilder.accept(
            Link.fromUriBuilder(uriInfo.getRequestUriBuilder()
                                       .replaceQueryParam(PAGE_QUERY_PARAM,
                                                          FIRST_PAGE))
                .rel(FIRST_REL)
                .build());

        linkStreamBuilder.accept(
            Link.fromUriBuilder(uriInfo.getRequestUriBuilder()
                                       .replaceQueryParam(PAGE_QUERY_PARAM,
                                                          pageCount))
                .rel(LAST_REL)
                .build());

        return linkStreamBuilder.build();
    }
}
</code></pre>
<p>La méthode <code>toLinks()</code> va déterminer quelles relations existent. Cette
implémentation suit des choix , comme le fait de ne pas renvoyer la relation
<em>self</em>, et bien sûr d&rsquo;autres peuvent être choisit.</p>
<p><code>uriInfo</code> est utilisé pour construire la nouvelle URI avec une méthode pratique
sur le builder, <code>replaceQueryParam(paramName,value)</code>. Cette approche
demande de s&rsquo;assurer que le paramètre de la requête ait bien le même nom ; il
est indispensable d&rsquo;uniformiser dans l&rsquo;application un minimum les mécanismes
de pagination, par exemple la classe <code>QueryParams</code> utilise une constante
pour le paramètre de la page :</p>
<pre><code class="language-java">@Data
public class QueryParams {
    @QueryParam(&quot;q&quot;) String question;

    @Min(value = 1, message = &quot;page start at 1&quot;)
    @QueryParam(PAGE_QUERY_PARAM) @DefaultValue(&quot;1&quot;) Integer page;
}
</code></pre>
<p>Enfin il faut remarquer que s&rsquo;il y a beaucoup de resources paginées, alors
il y a un problème de design. En effet, le code a plus de chance d&rsquo;être cassé,
ou d&rsquo;avoir des différences s&rsquo;il est dupliqué à plusieurs endroits.
Il y a moyen de faire mieux.</p>
<h2 id="jax-rs-une-solution-plus-générique">JAX-RS, une solution plus générique</h2>
<p>JAX-RS apporte depuis la version 2.0 la notion de <em>filtre</em> qui s&rsquo;appliquent sur
le <em>pipeline</em> de la requête. Il y a deux types de filtre, l&rsquo;un sur la requête,
le deuxième sur la réponse. Nous sommes ici intéressés par &ldquo;filtrer&rdquo; la réponse
Le code qui suit implémente à cet effet l&rsquo;interface <code>ContainerResponseFilter</code>
pour identifier identifier une <em>entité</em> <strong>paginée</strong> et de modifier la réponse en
conséquence.</p>
<pre><code class="language-java">@Provider
public class LinkPaginationContainerResponseFilter implements ContainerResponseFilter {
    public static final String X_TOTAL_COUNT = &quot;X-Total-Count&quot;;
    public static final String X_PAGE_COUNT = &quot;X-Page-Count&quot;;

    @Override
    public void filter(ContainerRequestContext requestContext,
                       ContainerResponseContext responseContext) {

        if (!(responseContext.getEntity() instanceof Paginated)) {
            return;
        }

        UriInfo uriInfo = requestContext.getUriInfo();
        Paginated entity = (Paginated) responseContext.getEntity();

        responseContext.setEntity(entity.currentPage);
        responseContext.getHeaders()
                       .addAll(LINK,
                               new LinkPagination(
                                   entity.currentPageIndex(),
                                   entity.pageCount()
                               ).toLinks(uriInfo).toArray(Link[]::new)
                       );
        responseContext.getHeaders().add(X_TOTAL_COUNT, entity.totalCount());
        responseContext.getHeaders().add(X_PAGE_COUNT, entity.pageCount());
    }
}
</code></pre>
<p>De la même manière on a besoin de <code>UriInfo</code> pour reconstruire les liens des
relations. En revanche l&rsquo;API du <code>ContainerResponseContext</code> est un peu moins
confortable que le builder de <code>Response</code>, notamment pour ajouter les entêtes à
la requête HTTP, il n&rsquo;y a pas par exemple de symétrie avec le <code>.links()</code>.</p>
<p>On indique que <code>SomePaginated</code> dispose du contrat <code>Paginated</code> :</p>
<pre><code class="language-java">public interface Paginated&lt;T&gt; {
    T currentPage();
    int currentPageIndex();
    int pageCount();
    int totalCount();
}
</code></pre>
<pre><code class="language-java">public class SomePaginated implements Paginated&lt;Page&gt; { /* ... */ }
</code></pre>
<p>Puis il suffira d&rsquo;écrire :</p>
<pre><code class="language-java">@GET @Path(&quot;search&quot;)
public void search(@BeanParam QueryParams queryParams,
                   @Suspended AsyncResponse asyncResponse) {

    SomePaginated results = // get paginated results
    asyncResponse.resume(results);
}
</code></pre>
<p>Ce qui permet d&rsquo;être simple à mettre en place pour des resources ultérieures.
Le code technique est géré à un seul endroit et évite donc les détériorations
possibles si le code était dupliqué sur plusieurs resources.</p>
<h1 id="éléments-à-prendre-en-compte">Éléments à prendre en compte</h1>
<ul>
<li>
<p>Faut-il utiliser une IRI absolue ou relative?</p>
<p>Par exemple l&rsquo;api pourrait être utilisée par un serveur intermédiaire exposé
sur un autre domaine, rendant l&rsquo;exploitation de ces liens délicate.</p>
</li>
<li>
<p>Faut-il pour la payload utiliser un type collection ou un type objet?</p>
<p>Un tableau a l&rsquo;avantage de représenter une collection d&rsquo;éléments directement.
Cependant pour des raisons métier il pourrait être voulu que le serveur
retourne également des méta-données métiers sur cette collection :
un flag d&rsquo;A/B testing, pour une recherche quelles options étaient actives,
etc. Ces informations peuvent être exposée dans les entêtes, mais est-ce
le bon endroit?</p>
</li>
<li>
<p>Ce qui amène alors à une autre réflexion si ces meta-donnés sant dans la
payload, est-ce les informations de paginations devrait y être aussi ?</p>
<p>Mon avis est que non car la pagination est une notion liée au protocole
d&rsquo;accès à la données, alors que les meta-données du métiers ne le sont
pas. Également le fait que ces données soient dans les entêtes n&rsquo;oblige
pas à parser la payload pour les utiliser.</p>
</li>
</ul>
<hr>
<p>Sur le même sujet mais relatif au traitement même de la requête de pagination,
mais relatif uniquement à Jersey
l'<a href="https://psamsotha.github.io/jersey/2017/01/07/jersey-pagination-with-spring-data.html">article suivant</a></p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="/2017/04/29/kafka-a-walking-skeleton/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">Kafka, a walking skeleton</span>
    </a>
    
    
    <a href="/2017/10/02/pagination_hateoas_link.en/" class="navigation-next">
      <span class="navigation-tittle">JAX-RS 2.0 pagination with Link header</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
        
        
        
        this.page.identifier = 'https://blog.arkey.fr/2017/10/02/pagination_hateoas_link/';
        this.page.title = 'Pagination en JAX-RS 2.0 avec le header Link';
        this.page.url = 'https://blog.arkey.fr/2017/10/02/pagination_hateoas_link/';
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "thecoffeeworkshop" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</article>


        </div>
        
    










<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin="anonymous"></script>
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    

<script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js" integrity="sha256-vrn14y7WH7zgEElyQqm2uCGSQrX/xjYDjniRUQx3NyU=" crossorigin="anonymous"></script>
<script type="text/javascript">
function addBlockSwitches() {
	$('.primary').each(function() {
		primary = $(this);
		createSwitchItem(primary, createBlockSwitch(primary)).item.addClass("selected");
		primary.children('.title').remove();
	});
	$('.secondary').each(function(idx, node) {
		secondary = $(node);
		primary = findPrimary(secondary);
		switchItem = createSwitchItem(secondary, primary.children('.switch'));
		switchItem.content.addClass('hidden');
		findPrimary(secondary).append(switchItem.content);
		secondary.remove();
	});
}

function createBlockSwitch(primary) {
	blockSwitch = $('<div class="switch"></div>');
	primary.prepend(blockSwitch);
	return blockSwitch;
}

function findPrimary(secondary) {
	candidate = secondary.prev();
	while (!candidate.is('.primary')) {
		candidate = candidate.prev();
	}
	return candidate;
}

function createSwitchItem(block, blockSwitch) {
	blockName = block.children('.title').text();
	content = block.children('.content').first().append(block.next('.colist'));
	item = $('<div class="switch--item">' + blockName + '</div>');
	blockSwitch.append(item);
	return {'item': item, 'content': content};
}

function globalSwitch() {
	$('.switch--item').each(function() {
		var blockId = blockIdForSwitchItem($(this));
		$(this).off('click');
		$(this).on('click', function() {
			selectedText = $(this).text()
			window.localStorage.setItem(blockId, selectedText);
			$(".switch--item").filter(function() {
				return blockIdForSwitchItem($(this)) === blockId;
			}).filter(function() {
				return $(this).text() === selectedText;
			}).each(function() {
				select($(this))
			});
		});
		if ($(this).text() === window.localStorage.getItem(blockId)) {
			select($(this))
		}
	});
}

function blockIdForSwitchItem(item) {
	idComponents = []
	idComponents.push(item.text().toLowerCase());
	item.siblings(".switch--item").each(function(index, sibling) {
		idComponents.push($(sibling).text().toLowerCase());
	});
	return idComponents.sort().join("-")
}

function select(selected) {
	selected.addClass('selected');
	selected.siblings().removeClass('selected');
	selectedContent = selected.parent().siblings(".content").eq(selected.index())
	selectedContent.removeClass('hidden');
	selectedContent.siblings().addClass('hidden');
}

$(addBlockSwitches);
$(globalSwitch);
</script>


    



    </body>
</html>

