<!DOCTYPE html>
<html lang="en">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.69.0" />

    
    
    

<title>Premier contact avec la perte d&#39;instances Zookeeper • The Coffee Workshop</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Premier contact avec la perte d&#39;instances Zookeeper"/>
<meta name="twitter:description" content="Zookeeper est un service de coordination distribuée. Son usage permet notamment de maintenir des informations de configuration, de faire du service discovery, de fournir des mécasnimes distribués de concurrence (lock)."/>

<meta property="og:title" content="Premier contact avec la perte d&#39;instances Zookeeper" />
<meta property="og:description" content="Zookeeper est un service de coordination distribuée. Son usage permet notamment de maintenir des informations de configuration, de faire du service discovery, de fournir des mécasnimes distribués de concurrence (lock)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.arkey.fr/2016/10/25/first-contact-with-zookeeper-peer-failure/" />
<meta property="article:published_time" content="2016-10-25T00:00:00+00:00" />
<meta property="article:modified_time" content="2016-10-25T00:00:00+00:00" /><meta property="og:site_name" content="Arkey" />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.f78f3e4d26f5b0a2e0bd35c042d656341c3d1f93c7acca8e23906a48d6b871fb.css" integrity="sha256-948&#43;TSb1sKLgvTXAQtZWNBw9H5PHrMqOI5BqSNa4cfs=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    
    <link rel="shortcut icon" sizes="192x192" href="/android-192-favicon.png">

    
    <link rel="shortcut icon" href="/android-192-favicon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/v4-shims.min.css" integrity="sha256-wN7QJaqAwQ03kgUhyN4EU2phRdDkLrQYbFe0EvpQ60U=" crossorigin="anonymous" />

    
    


    
</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://blog.arkey.fr">The Coffee Workshop</a>
      </span>
      
      
        <div class="author-image">
          <img src="https://www.gravatar.com/avatar/f31c7fbcbb0766d0632d96fd7e74b649?s=240&d=mp" class="img--circle img--headshot element--center" alt="gravatar">
        </div>
      
      <p class="site__description">
         Java mostly, and general tech 
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">The Coffee Workshop</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/"><span class='fa-icon'><i class='fas fa-home'></i></span><code>cd <em>~</em></code>
						<span></span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/posts/"><span class='fa-icon'><i class='fas fa-stream'></i></span><code>ls <em>posts/*</em></code>
						<span></span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/series/"><span class='fa-icon'><i class='fas fa-list-alt'></i></span><code>grep -o <em>series</em> posts/* | sort -u</code>
						<span></span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/tags/"><span class='fa-icon'><i class='fas fa-tags'></i></span><code>grep -o <em>tags</em> posts/* | sort -u</code>
						<span></span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/cool-stuff/"><span class='fa-icon'><i class='fas fa-thumbtack'></i></span><code>cd <em>cool-stuff</em></code>
						<span></span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/whoami/"><span class='fa-icon'><i class='fas fa-id-card'></i></span><code>whoami</code>
						<span></span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/@BriceDutheil" rel="me"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="bird" class="svg-inline--fa fa-bird fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a>
	
	
	
	<a href="https://github.com/bric3" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://speakerdeck.com/bric3" rel="me"><i class="fab fa-speaker-deck" aria-hidden="true"></i></i></a>
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/dutheilbrice" rel="me"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="pro-network" class="svg-inline--fa fa-pro-network fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a>
	
	
	<a href="https://stackoverflow.com/users/48136/brice" rel="me"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2010 - 2020 Brice Dutheil
  
    <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>
  
</div>



  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>Premier contact avec la perte d&#39;instances Zookeeper</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> 2016-10-25
    
    
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/tags/zookeeper">zookeeper</a>
           
      
          <a class="badge badge-tag" href="/tags/cluster">cluster</a>
           
      
          <a class="badge badge-tag" href="/tags/ensemble">ensemble</a>
          
      
    
    
    <br/>
    <i class="fas fa-clock"></i> 7 min read
</div>


  </header>
  
  
  <div class="post">
    <p>Zookeeper est un service de coordination distribuée. Son <a href="https://zookeeper.apache.org/doc/r3.4.9/recipes.html">usage</a> permet notamment de maintenir des informations de configuration, de faire du service discovery, de fournir des mécasnimes distribués de concurrence (lock).</p>
<p>Bien qu&rsquo;aujourd&rsquo;hui d&rsquo;autres logiciels plus pratiques et plus efficaces sont apparus, Zookeeper n&rsquo;en reste pas moins une pièce maitresse de certains outils comme <a href="http://hadoop.apache.org/">Hadoop</a> ou <a href="https://kafka.apache.org/documentation#quickstart_startserver">Kafka</a>.</p>
<h2 id="comment-zookeeper-fonctionne-">Comment zookeeper fonctionne ?</h2>
<p>Zookeeper peut fonctionner avec une seule instance ou avec plusieur, dasn ce cas appelé <em>ensemble Zookeeper</em>. L&rsquo;intérêt de Zookeeper est de fonctionner de manière distribué, une seul instance peut marcher, mais <strong>il n&rsquo;y a pas de continuité de service</strong> si cette seule instance s&rsquo;arrête.</p>
<p>Cet <em>ensemble</em> d&rsquo;instance Zookeeper vont donc partager un état. Lorsqu&rsquo;un changement doit avoir lieu sur cet état, le changement n&rsquo;est pas considéré comme terminé avec succès tant que le quorum de l&rsquo;ensemble Zookeeper n&rsquo;a pas été atteint. Ce qui veut dire <strong>plus de la la moitié</strong> des noeuds doivent acquitter l'écriture.</p>
<p>Comme il s&rsquo;agit d&rsquo;un système distribué il peut y avoir des raisons pour les quelles une instance Zookeeper n&rsquo;est pas disponible (opération de maintenance, etc.). La règle de calcul pour établir le nombre d&rsquo;instances nécéssaire pour qu&rsquo;un ensemble supporte la perte d&rsquo;un certain nombre de membre est :</p>
<pre><code>( 2 x instance non disponible ) + 1
</code></pre>
<ul>
<li>Pour qu&rsquo;un ensemble puisse supporter la perte de une instance, il faudra 3 serveurs.</li>
<li>Pour qu&rsquo;un ensemble puisse supporter la perte de deux instances, il faudra 5 serveurs.</li>
<li>Pour qu&rsquo;un ensemble puisse supporter la perte de trois instances, il faudra 7 server.</li>
</ul>
<p>(À noter que plus il y a de noeuds plus le quorum <a href="http://zookeeper.apache.org/doc/r3.4.9/zookeeperOver.html#Performance">met longtemps à s'établir</a> ; dans la majorité des cas un cluster de 3 ou 5 instances sera suffisant)</p>
<p>Cette formule conduit naturellement au fait que le nombre minimum nécéssaire pour un ensemble zookeeper sera toujours impair. Si le nombre de l&rsquo;ensemble était pair, le quorum ne serait toujours atteint qu&rsquo;avec plus de la moitié.</p>
<p>Exemple: Un cluster de 6 perds 2 instances, il en reste 4, le quorum peut être atteint. S&rsquo;il en en perd 3, il reste 3 instances, le quorum ne peut pas être atteint.</p>
<p>Enfin un ensemble zookeeper choisit toujours un leader, ce leader est choisit également par quorum. Les autres instances sont des <em>suiveurs</em> (follower). Toutes les écritures sont transferrée au leader. Les lectures peuvent en revanche être traitées par les autres instances.</p>
<p>Pour plus d&rsquo;info j&rsquo;invite à poursuivre sur le site de <a href="https://zookeeper.apache.org/doc/trunk/zookeeperOver.html">zookeeper</a>.</p>
<blockquote>
<p>À noter comme cet article n&rsquo;utilise pas  le terme <em>noeud</em> pour parler d&rsquo;une <em>instance</em> ou d&rsquo;un <em>serveur</em> Zookeeper, la raison est que le terme noeud (<code>node</code> donc) a une signification spéciale pour zookeeper. En effet un <code>node</code> correspond à un point dans <a href="https://zookeeper.apache.org/doc/r3.4.9/zookeeperOver.html#Nodes+and+ephemeral+nodes">l&rsquo;arborescence Zookeeper</a>.</p>
</blockquote>
<h2 id="mise-en-pratique">Mise en pratique</h2>
<p>Pour s&rsquo;amuser un peu avec Zookeeper et ses collègues. Il est possible assez facilement de voir comment un ensemble zookeeper réagit à la perte de ses membres.</p>
<p>Cet exemple se base sur un ensemble de 5 instances. Qui est dans un premier temps en local.</p>
<h3 id="configuration">Configuration</h3>
<p>Bien sûr après avoir téléchargé la distributon de zookeeper, il faut préparer quelques répertoires</p>
<pre><code class="language-bash">mkdir -p ~/zktests/local/cluster
cd ~/zktests/local/cluster
wget http://www-eu.apache.org/dist/zookeeper/zookeeper-3.4.9/zookeeper-3.4.9.tar.gz
tar zxf zookeeper-3.4.9.tar.gz
</code></pre>
<p>Depuis ce dossier, il faut créer un fichier de configuration <code>zoo.template.cfg</code> qui servira de template pour toute les instances. Le texte à remplacer sera <code>{{peer}}</code> et <code>{{dataDir}}</code> :</p>
<pre><code class="language-properties">server.1=localhost:28881:38881
server.2=localhost:28882:38882
server.3=localhost:28883:38883
server.4=localhost:28884:38884
server.5=localhost:28885:38885
syncLimit=5
initLimit=10
tickTime=2000
quorumListenOnAllIPs=true
clientPort=2181{{peer}}
autopurge.purgeInterval=24
dataDir={{dataDir}}
autopurge.snapRetainCount=10
</code></pre>
<p>Ces placeholders devront être remplacé par le numéro du membre zookeeper. Ensuite il faut créer la structure des répertoires de chaque membre ainsi que les fichiers correspondants :</p>
<ul>
<li>Donc les 5 fichiers <code> zoo.$i.cfg</code> créés depuis <code>zoo.template.cfg</code> dans le répertoire courant (<code>~/zktests/local/cluster</code>)</li>
<li>Ensuite créer les 5 dossiers <code>$i</code>, c&rsquo;est là ou va être stockée les données de chaque instance (défini par la propriété <code>dataDir</code>)</li>
<li>Créer le fichier <code>myid</code> dans chacun de ces dossiers, ce fichier contiendra l&rsquo;identifiant du membre zookeeper (i.e. <code>$i</code>)</li>
</ul>
<pre><code class="language-bash">for i in {1..5}; do echo zk-$i; echo &quot;zk-peer-$i config file&quot;; cat zoo.template.cfg | sed -e &quot;s|{{dataDir}}|$(pwd)/$i|g&quot; -e &quot;s|{{peer}}|$i|g&quot; &gt; zoo.$i.cfg; done
for i in {1..5}; do mkdir $i; done
for i in {1..5}; do echo $i &gt; $i/myid; done
</code></pre>
<h3 id="lancer-lensemble">Lancer l&rsquo;ensemble</h3>
<p>Une fois que tout est près, on peut lancer chaque instance de zookeeper. La commande suivante permet de lancer ces 5 instances depuis le répertoire en cours (<code>~/zktests/local/cluster</code>)</p>
<pre><code class="language-bash">for i in {1..5}; do env ZOO_LOG_DIR=`pwd`/$i `pwd`/zookeeper-3.4.9/bin/zkServer.sh start `pwd`/zoo.$i.cfg; done
jps -v
</code></pre>
<p><code>jps</code> montre que ces instances tournent, le nom du programme est <code>QuorumPeerMain</code>. Mais est-ce que le cluster fonctionne correctement ? Pour cela il faut interroger les membres en envoyant sur le le port client (<code>clientPort</code>), un <a href="https://zookeeper.apache.org/doc/trunk/zookeeperAdmin.html#The+Four+Letter+Words"><strong>mot à 4 lettres</strong></a> ; celui qui nous intéresse est le mot <code>stat</code>.</p>
<pre><code class="language-bash">for i in {1..5}; do echo &quot;\nzk peer $i\n---------&quot;; echo stat | nc localhost 2181$i; done
</code></pre>
<p>Il devrait y avoir 5 blocs de statistiques, avec les modes de chaque noeud (follower ou leader).</p>
<h3 id="stopper-lensemble-zookeeper">Stopper l&rsquo;ensemble Zookeeper</h3>
<p>Pour stopper correctement un ensemble il faut utiliser le script shell avec la commande <code>stop</code> la commande qui suit stoppe les 5 instances démarrées.</p>
<pre><code class="language-bash">for i in {1..5}; do env ZOO_LOG_DIR=`pwd`/$i `pwd`/zookeeper-3.4.9/bin/zkServer.sh stop `pwd`/zoo.$i.cfg; done
</code></pre>
<h2 id="supprimer-le-membre-leader-de-lensemble-zookeeper">Supprimer le membre leader de l&rsquo;ensemble Zookeeper</h2>
<p>Sur cet ensemble Zookeeper bien portant, on voudrait donc jouer avec la perte d&rsquo;une instance.</p>
<p>Pour monitorer les 5 noeuds en continue la commande suivante se base sur <code>watch</code></p>
<pre><code class="language-bash">watch --difference --color 'for i in {1..5}; do printf &quot;\nzk peer $i\n&quot;; echo stat | nc localhost 2181$i; done'
</code></pre>
<p>Une fois qu&rsquo;on peut voir l'état de chaque noeud, on peut dans une console séparée, de préférence à coté.</p>
<h3 id="stopper-linstance-proprement-avec-le-script-zkserver">Stopper l&rsquo;instance proprement avec le script <code>zkServer</code></h3>
<p>Il faut en premier trouver le leader (<code>mode : leader</code>), par exemple si le server <code>2</code> est le leader on devrait voir quelque chose de similaire à :</p>
<pre><code>zk peer 2
Zookeeper version: 3.4.6-1569965, built on 02/20/2014 09:09 GMT
Clients:
 /0:0:0:0:0:0:0:1:64572[0](queued=0,recved=1,sent=0)

Latency min/avg/max: 0/0/0
Received: 202
Sent: 201
Connections: 1
Outstanding: 0
Zxid: 0x700000000
Mode: leader
Node count: 4
</code></pre>
<p>On peut stopper cette instance avec la commande suivante:</p>
<pre><code class="language-bash">env ZOO_LOG_DIR=`pwd`/2 `pwd`/zookeeper-3.4.9/bin/zkServer.sh stop `pwd`/zoo.2.cfg
</code></pre>
<p>Une fois le leader supprimé, le cluster élit un nouveau leader parmis les membres restants.</p>
<p>En local l'élection est rapide. Le cluster n&rsquo;est <strong>indisponible</strong> qu&rsquo;un bref moment, mais il est quand même indisponible, sur réseau ce processus peut-être significativement plus long.</p>
<p>Maintenant supprimons un deuxième serveur, cet ensemble est constitué de cinq membre, la perte d&rsquo;un autre membre est donc tolérée.
Après la réélection le nouveau leader est l&rsquo;instance <code>5</code> :</p>
<pre><code class="language-bash">env ZOO_LOG_DIR=`pwd`/5 `pwd`/zookeeper-3.4.9/bin/zkServer.sh stop `pwd`/zoo.5.cfg
</code></pre>
<p>Une fois encore la suppression d&rsquo;un noeud montre une petite période d&rsquo;indisponibilité de l&rsquo;ensemble.</p>
<h3 id="stopper-linstance-avec-kill">Stopper l&rsquo;instance avec <code>kill</code></h3>
<p><code>kill</code> envoie le signal <code>TERM</code> (<code>15</code>), ce qui permet au processus de se terminer gracieusement.</p>
<p>Relancer tous les membres arretés, s&rsquo;il s&rsquo;agit des membres <code>2</code> et <code>5</code> il suffit de faire :</p>
<pre><code class="language-bash">env ZOO_LOG_DIR=`pwd`/2 `pwd`/zookeeper-3.4.6/bin/zkServer.sh stop `pwd`/zoo.2.cfg
env ZOO_LOG_DIR=`pwd`/5 `pwd`/zookeeper-3.4.6/bin/zkServer.sh stop `pwd`/zoo.5.cfg
</code></pre>
<p>En adaptant le scénario, c&rsquo;est à dire de trouver le leader, il fautdra trouver le <em>pid</em> du processus zookeeper :</p>
<p>Si le leader est le membre <code>1</code>, alors son pid peut se trouver dans le dossier de donnée (<code>dataDir</code>) de zookeeper. Un fichier qui contient ce pid est stocké dans ce répertoire sous le nom <code>zookeeper_server.pid</code>, on peut changer ce dossier avec la variable d&rsquo;environnement <code>ZOOPIDFILE</code>.</p>
<p>Donc pour terminer le process zookeeper :</p>
<pre><code class="language-bash">kill $(&lt; 1/zookeeper_server.pid)
</code></pre>
<p>De la même manière on peut observer que l&rsquo;ensemble est indisponible un court moment tant qu&rsquo;un nouveau leader n&rsquo;est pas élu.</p>
<h3 id="stopper-linstance-avec-kill--9">Stopper l&rsquo;instance avec <code>kill -9</code></h3>
<p>Même scénario qu&rsquo;au dessus pour retrouver le pid mais cette fois on envoie le signal <code>KILL</code> (<code>9</code>) qui tue le processus sans lui permettre de terminer gracieusement. Si le leader est le membre <code>2</code>.</p>
<pre><code class="language-bash">kill -KILL $(&lt; 2/zookeeper_server.pid)
</code></pre>
<p>Encore une fois le cluster zookeeper tolère la perte brutale d&rsquo;un noeud, mais demande un peu de temps pour élire un nouveau leader.</p>
<h3 id="rendre-lensemble-indisponible">Rendre l&rsquo;ensemble indisponible</h3>
<p>Il s&rsquo;agit d&rsquo;un cluster de 5 membres, celui-ci supporte la défaillance de 2 membres. Donc pour le rendre indisponible il faut éliminer un autre processus Zookeeper qu&rsquo;il soit leader ou pas:</p>
<pre><code class="language-bash">kill -KILL $(&lt; 4/zookeeper_server.pid)
</code></pre>
<p>Les stat des deux noeuds restant affichent alors le message :</p>
<pre><code>This ZooKeeper instance is not currently serving requests
</code></pre>
<h2 id="wrap-up">Wrap Up</h2>
<p>Un ensemble Zookeeper est capable de se remettre de la perte de ces membres tant que le quorum peut-être atteint. Cependant la perte des membres introduit une fenêtre d&rsquo;indisponibilité.
Qui plus est, les processus de cet ensemble utilise l&rsquo;interface <em>loopback</em> ; reproduire ces scénarios sur des machines différentes montrera que le réseau introduit des latences. Zookeeper n&rsquo;aime pas du tout les latences (par exemple une instance qui a des problèmes peut ralentir considérablement le reste de l&rsquo;ensemble Zookeeper pour le vote d&rsquo;acquittement d'écriture ou pour élire un nouveau leader).</p>
<p>Ces considérations sont à prendre en compte lorsqu&rsquo;une maintenance est à prévoir sur les machines qui hébergent ces processus.</p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="/2016/04/01/1000_first_primes/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">The First 1,000 Primes</span>
    </a>
    
    
    <a href="/2016/12/05/make-docker-container-access-host-ssh-tunnel/" class="navigation-next">
      <span class="navigation-tittle">Connecter un container docker sur un tunnel ssh OSX</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
        
        
        
        this.page.identifier = 'https://blog.arkey.fr/2016/10/25/first-contact-with-zookeeper-peer-failure/';
        this.page.title = 'Premier contact avec la perte d\x27instances Zookeeper';
        this.page.url = 'https://blog.arkey.fr/2016/10/25/first-contact-with-zookeeper-peer-failure/';
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "thecoffeeworkshop" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</article>


        </div>
        
    










<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script><script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    
    




    



    </body>
</html>
